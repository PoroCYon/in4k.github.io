<!DOCTYPE html>
<!-- saved from url=(0040)http://keyj.emphy.de/applied-mediocrity/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>KeyJ's Blog  : Blog Archive   » Technical details about »Applied Mediocrity«</title>
<meta name="generator" content="WordPress 4.9.6">

<link rel="stylesheet" href="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/style.css" type="text/css">
<link rel="alternate" type="application/rss+xml" title="KeyJ&#39;s Blog RSS Feed" href="https://keyj.emphy.de/feed/">
<link rel="pingback" href="http://keyj.emphy.de/xmlrpc.php">

<style type="text/css">
	body { background:#d8d0b8 url("http://keyj.emphy.de/wp-content/themes/keyj2/sidebar.png") repeat-y; }
	@media print {
		body { background:white; margin:0; }
	}
</style>

<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="KeyJ&#39;s Blog » Technical details about »Applied Mediocrity« Comments Feed" href="https://keyj.emphy.de/applied-mediocrity/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/keyj.emphy.de\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.6"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="https://api.w.org/" href="https://keyj.emphy.de/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://keyj.emphy.de/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://keyj.emphy.de/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Proposal: A file system for Live CDs" href="https://keyj.emphy.de/profs-proposal/">
<link rel="next" title="pdfgen, an image-to-PDF converter tool" href="https://keyj.emphy.de/pdfgen/">
<meta name="generator" content="WordPress 4.9.6">
<link rel="canonical" href="https://keyj.emphy.de/applied-mediocrity/">
<link rel="shortlink" href="https://keyj.emphy.de/?p=285">
<link rel="alternate" type="application/json+oembed" href="https://keyj.emphy.de/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fkeyj.emphy.de%2Fapplied-mediocrity%2F">
<link rel="alternate" type="text/xml+oembed" href="https://keyj.emphy.de/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fkeyj.emphy.de%2Fapplied-mediocrity%2F&amp;format=xml">
</head>
<body>
<div id="page">

<div id="logo">
	<div>Welcome to the website of</div>
	<a href="https://keyj.emphy.de/"><img src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/logo.png" width="156" height="80" alt="KeyJ"></a>
</div>

<ul id="sidebar">

<li id="search-3" class="widget widget_search"><form method="get" id="searchform" action="https://keyj.emphy.de/">
<div><input type="text" value="" name="s" id="s">
<input type="submit" id="searchsubmit" value="Search">
</div>
</form>
</li>
<li id="pages-3" class="widget widget_pages"><h2 class="widgettitle">Pages</h2>
		<ul>
			<li class="page_item page-item-2"><a href="https://keyj.emphy.de/about/">About me</a></li>
<li class="page_item page-item-35 page_item_has_children"><a href="https://keyj.emphy.de/projects/">Projects</a>
<ul class="children">
	<li class="page_item page-item-37"><a href="https://keyj.emphy.de/projects/demoscene/">Demoscene</a></li>
	<li class="page_item page-item-612"><a href="https://keyj.emphy.de/projects/tools-scripts/">Tools &amp; Scripts</a></li>
	<li class="page_item page-item-36"><a href="https://keyj.emphy.de/projects/old-stuff/">Old Stuff</a></li>
	<li class="page_item page-item-41"><a href="https://keyj.emphy.de/projects/studies/">Studies</a></li>
</ul>
</li>
		</ul>
		</li>
<li id="categories-3" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-6"><a href="https://keyj.emphy.de/category/computer-fun/" title="Funny, interesting or absurd findings and hacks.">Computer Fun</a>
<ul class="children">
	<li class="cat-item cat-item-12"><a href="https://keyj.emphy.de/category/computer-fun/demoscene/" title="Anything that has to do with the demoscene.">Demoscene</a>
	<ul class="children">
	<li class="cat-item cat-item-13"><a href="https://keyj.emphy.de/category/computer-fun/demoscene/party-reports/" title="Reports from demoscene parties I&#39;ve been attending.">Party Reports</a>
</li>
	</ul>
</li>
	<li class="cat-item cat-item-10"><a href="https://keyj.emphy.de/category/computer-fun/hacks/" title="Sometimes useless, sometimes useful, but always interesting software I wrote in my free time.">Hacks</a>
	<ul class="children">
	<li class="cat-item cat-item-11"><a href="https://keyj.emphy.de/category/computer-fun/hacks/ipod/" title="Anything that has to do with iPod hacking.">iPod</a>
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="https://keyj.emphy.de/category/misc/" title="Everything that doesn&#39;t fit into the other categories.">Other</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://keyj.emphy.de/category/personal/" title="Stuff that has to do with myself or with friends of mine.">Personal</a>
</li>
	<li class="cat-item cat-item-46"><a href="https://keyj.emphy.de/category/reviews/" title="Reviews of (or rants about) new technology (software or hardware), movies, or whatever is worth writing a review for :)">Reviews</a>
</li>
		</ul>
</li>
<li id="ctc-3" class="widget ctc"><h2 class="widgettitle">Tags</h2>
<div class="ctc"><a href="https://keyj.emphy.de/tag/4k/" class="ctc-tag tag-link-65" title="5 topics" rel="tag" style="font-size: 9.8181818181818pt; color: #00008d;">4k</a>
<a href="https://keyj.emphy.de/tag/apple/" class="ctc-tag tag-link-35" title="5 topics" rel="tag" style="font-size: 9.8181818181818pt; color: #00008d;">Apple</a>
<a href="https://keyj.emphy.de/tag/benchmark/" class="ctc-tag tag-link-18" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">benchmark</a>
<a href="https://keyj.emphy.de/tag/blog/" class="ctc-tag tag-link-77" title="9 topics" rel="tag" style="font-size: 13.454545454545pt; color: #00006b;">blog</a>
<a href="https://keyj.emphy.de/tag/breakpoint/" class="ctc-tag tag-link-15" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">Breakpoint</a>
<a href="https://keyj.emphy.de/tag/demoscene/" class="ctc-tag tag-link-131" title="14 topics" rel="tag" style="font-size: 18pt; color: #000040;">Demoscene</a>
<a href="https://keyj.emphy.de/tag/evoke/" class="ctc-tag tag-link-28" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">Evoke</a>
<a href="https://keyj.emphy.de/tag/games/" class="ctc-tag tag-link-30" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">games</a>
<a href="https://keyj.emphy.de/tag/graphics/" class="ctc-tag tag-link-39" title="5 topics" rel="tag" style="font-size: 9.8181818181818pt; color: #00008d;">graphics</a>
<a href="https://keyj.emphy.de/tag/h264/" class="ctc-tag tag-link-17" title="6 topics" rel="tag" style="font-size: 10.727272727273pt; color: #000085;">H.264</a>
<a href="https://keyj.emphy.de/tag/impressive/" class="ctc-tag tag-link-26" title="3 topics" rel="tag" style="font-size: 8pt; color: #00009f;">Impressive</a>
<a href="https://keyj.emphy.de/tag/ipod/" class="ctc-tag tag-link-130" title="8 topics" rel="tag" style="font-size: 12.545454545455pt; color: #000073;">iPod</a>
<a href="https://keyj.emphy.de/tag/jpeg/" class="ctc-tag tag-link-87" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">JPEG</a>
<a href="https://keyj.emphy.de/tag/linux/" class="ctc-tag tag-link-47" title="7 topics" rel="tag" style="font-size: 11.636363636364pt; color: #00007c;">Linux</a>
<a href="https://keyj.emphy.de/tag/mpui/" class="ctc-tag tag-link-66" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">MPUI</a>
<a href="https://keyj.emphy.de/tag/opengl/" class="ctc-tag tag-link-43" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">OpenGL</a>
<a href="https://keyj.emphy.de/tag/rant/" class="ctc-tag tag-link-49" title="14 topics" rel="tag" style="font-size: 18pt; color: #000040;">rant</a>
<a href="https://keyj.emphy.de/tag/repear/" class="ctc-tag tag-link-25" title="3 topics" rel="tag" style="font-size: 8pt; color: #00009f;">rePear</a>
<a href="https://keyj.emphy.de/tag/video/" class="ctc-tag tag-link-96" title="4 topics" rel="tag" style="font-size: 8.9090909090909pt; color: #000096;">video</a>
<a href="https://keyj.emphy.de/tag/windows/" class="ctc-tag tag-link-41" title="5 topics" rel="tag" style="font-size: 9.8181818181818pt; color: #00008d;">Windows</a></div></li>
<li id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a href="http://keyj.emphy.de/wp-admin">Site Admin</a><br>
<a href="http://keyj.emphy.de/feed"><img src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/rss2.png" alt="RSS"> Post Feed</a><br>
<a href="http://keyj.emphy.de/gdpr">Privacy Policy</a><br>
</div></li>
	

</ul>

<div id="content">

			
						
			<div class="post" id="post-285">
				<h1><a href="https://keyj.emphy.de/applied-mediocrity/" rel="bookmark" title="Permanent Link to Technical details about »Applied Mediocrity«">Technical details about »Applied Mediocrity«</a></h1>
				<div class="date">(September 4, 2009)</div>
				
				<div class="entry">
					<p>As you may or may not have noticed, my <a href="http://keyj.emphy.de/?page_id=37">latest intro</a> won the PC 64k competition at <a href="http://www.evoke.eu/2009/">Evoke 2009</a>. Unlike my previous demos and intros, it actually featured a few effects that go beyond fixed-function rendering or per-pixel lighting. For all who are interested in how it works, I’ve written this small article that explains how each of the eight effects in the intro is done, as well as some general insight into the creation process of the intro.<br>
<span id="more-285"></span></p>
<h3>Design</h3>
<p>First and foremost: There is no such thing as design in this intro. It is a simple effects show, and it was meant to be one from the start. Also, there’s no real »flow« (whatever that word may mean to you) in the intro. The only thing that connects the scenes is some half-hearted attempts at transitions or camera moves so that one scene starts with a solid color that is left behind from the previous scene.</p>
<p>The name »Applied Mediocrity« is a slight hint at how Kakiarts’ (moderate) success comes from: Even if every demo or intro we ever did is only mediocre from a technical point of view, we still appear to have some weird kind of charm that makes all the difference – hence <u>applied</u> mediocrity.</p>
<h3>Technology</h3>
<p>The intro is Win32-only, mainly because the only external library it relies on, farbrausch’s <a href="http://1337haxorz.de/products.html#v2">V2 synthesizer system</a> is Win32-only. If there was a Linux port of this synthesizer (or any other halfway decent synthesizer), I could have compiled the intro for Linux easily: There are no Win32isms in the code and there should be no MSVCisms eithers, a port from Win32 to SDL already exists because the engine used in this intro is basically the same as in »8-Bit Wonderland«, even the setup dialog has already been ported from Win32 to Gtk+, and the graphics are OpenGL anyway.</p>
<p>I made sure that the intro runs well on recent graphics chips of both major manufacturers. Development was done on an nVidia GeForce 8600M GT, and ATI compatibility was checked with a Radeon HD3850 and HD4370. I didn’t have regular access to the ATI boxes, so I just used <a href="http://developer.amd.com/gpu/shader/Pages/default.aspx">AMD GPU ShaderAnalyzer</a> most of the time. To the never-ending nVidia vs. ATI wars I can just say that even though ATI made me use a workaround for a missing feature at one point in the development process, it was nVidia where I witnessed the only real drawing bug.</p>
<style type="text/css">.scene { width:256px; height:144px; float:right; margin-left:8px; border:1px solid #50442a; } .figure { display:block; text-align:center; margin:8px auto 0 auto; border:1px solid #50442a; } .figcaption { width:80%; font-size:11px; font-style:italic; text-align:center; margin:0 auto 8px auto; }</style>
<h3 style="clear:both;">Effect #1: Intro with Vector Graphics</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_vector.jpg">The first scene writes some text on artificial paper and puts some symbols around it. This is a very simple effect, but nevertheless it required much work, because I had to write an (almost) full vector graphics engine. The main parts of this are a TrueType importer (which is executed during initialization of the intro) and an SVG importer which converts paths to a compact, quantized (8 bits per coordinate) internal representation that compresses well. The tesselation into OpenGL primitives is thankfully done by the standard GLU library, but subdividing the Bézier curves into small line segments is still done »by hand«. Unfortunately, all this effort doesn’t show and it’s nothing special either – it’s just 2D vector graphics 101.</p>
<p>The scene consists of four subparts. The first part contains the Kakiarts logo and group name. The second part writes the text »presents the 64k intro«, which is surrounded by symbols from all previous Kakiarts 64k intros, not limited to those I made myself: There’s the vortex symbol from »Vortex« and »Vortex 2«, the rastered cube from the loader of »rastro«, a power pole from »breakloose«, the butterfly from »riot of flowers« and a hedgehog from »3D Igel« (though it’s very small because it’s very very ugly :).<br>
The next part mentions the intro’s name, surrounded by tentacle-like things. I liked the tentacles so much that I re-used them later for some transitions and the loader, making them the only consistent design element of the intro. The last part is pure Evoke crowdpleasing featuring the legendary »ZVOKZ« logo.</p>
<h3 style="clear:both;">Effect #2: Reflecting spikeball</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_warpball.jpg">Originally this effect was intended to simulate some kind of <a href="http://en.wikipedia.org/wiki/Ferrofluid">ferrofluid</a>, but the result didn’t look very realistic. However, many people still recognize the ball as something made from a ferrofluid, so it can’t be that far from reality, except that the spikes are red instead of black :)</p>
<p>The ball is rendered from a static, finely tesselated mesh of a subdivided icosahedron. The spikes are generated inside the vertex shader and the pixel shader just applies the reflections from the environment. There are two cubemaps involved in this process, both of which are static: Obviously, there’s a cubemap for the (static) background that is reflected in the spikeball. The other cubemap is called the »spikemap« – it’s a grayscale cubemap where spikes are entered as white spots.</p>
<p>Using the spikemap, the vertex shader computes the actual position of each vertex, based on the base vertex position (which is always a point on the ball mesh), scaled by the value from the spikemap. That’s also why the intro requires a Shader Model 4.0 graphics card: Vertex Texture Fetch is available on SM 3.0 hardware for very few pixel formats only, and I simply didn’t want to convert the texture. Normals are generated by fetching 4 additional samples around each vertex and computing the cross product from the differences of the positions in each direction.</p>
<p>Even though the spikemap is technically a cube map, it’s actually just a simple 2D texture containing six different »subtextures« for each of the cube map views. The conversion from cube map texture coordinates to 2D texture coordinates is done in the vertex shader, too. I use this peculiar method because the AMD ShaderAnalyzer told me that cube maps can’t be sampled in vertex shaders on ATI hardware, so I had to do this workaround.</p>
<p><img class="figure" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/spikemap.jpg" width="288" height="192"></p>
<p class="figcaption">That’s what the spike map looks like. Originally, it’s grayscale, I just colored it here so you can tell the cube map faces apart.</p>
<p>The spikemap is generated at runtime by rendering lots of small non-overlapping circular sparks from six views and merging them into a single texture.</p>
<h3 style="clear:both;">Effect #3: Field of spheres</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_balls.jpg">This effect is basically the 3D version of »Vortex 2«’s last effect. Technically, it’s really nothing special: A field of some 10,000 balls with dents arranged on a simple heightmap, and the dents follow an »attractor« that is drawn as a small spark of light. The camera path is the usual sin/cos stuff – in fact, everything in »Applied Mediocrity« is sin/cos and translations; no splines were used at all.</p>
<p>To make the framerate of the scene bearable, some ultra-primitive form of frustum culling is used: The dot product of the normalized view direction vector and the normalized distance between the camera and each ball is computed, and if the result is below a certain threshold, the ball is culled. In addition to that, the ball meshes are available in four levels of detail (2720, 720, 200 and 60 vertices). LOD selection is done based on the distance from the camera position.</p>
<p><img class="figure" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/ball_lod.png" width="459" height="104" style="border:none;"></p>
<p class="figcaption">The ball in different levels of detail.</p>
<p>To add some extra effect, the scene also uses a primitive form of motion blur. In addition to the scene itself, another image containing »motion vectors« (MVs) is drawn. This image has a gray background. A course approximation of each ball (unshaded, extremely low-poly, without the dent, and a little bit larger than the original) is drawn unshaded in a solid color that encodes the difference in the screen position of the ball from the last frame to the current one. E.g. if the ball’s center was at screen position (500, 400) in the last frame and is at position (510, 395) now, the ball is drawn in the color (128+510-500, 128+395-400, 128) = (138, 123, 128).</p>
<p><img class="figure" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/mvfield.jpg" width="512" height="288"></p>
<p class="figcaption">Example motion vector field.</p>
<p>This motion vector field image is then used by a post-processing shader to apply motion blur. The color values from the MV field are used to control the direction and length of the blur for each pixel. 8 samples are taken along the blur direction and averaged. The same filter is applied another time with only one-eighth of the blur length, generating an image that is roughly equivalent to a single-pass 64-tap blur.</p>
<p>The end result is a decent-looking motion blur, but at the edges of the image and at some places between the balls, artifacts can be seen. However, the motion is quick enough that they usually aren’t apparent when watching the scene the first few times ;)</p>
<h3 style="clear:both;">Effect #4: Truchet tunnel</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_truchet.jpg">While the previous scene was the extension of a former 2D scene to 3D, this is the reverse: The »tube lattice« scene from Vortex 2 showed a three-dimensional <a href="http://mathworld.wolfram.com/TruchetTiling.html">Truchet tiling</a>, and this scene has a 2D Truchet tiling mapped on the walls of a tunnel (actually a torus). This tiling has the interesting property of building anything from simple circles to complex twisted paths that go on over hundreds of tiles.</p>
<p>Since a Truchet tiling alone doesn’t look all that interesting – especially not when in motion – I added some color to it. Each tile has four »ports« (as I call them) on its upper, lower, left and right edges. Each of these ports is assigned a color and the colors of each pair of ports are blended along the circle connecting them. Since it’s a continuous tiling, the color of e.g. the right port of a tile must be the same as the left port of the right neighbor tile. In fact, it’s actually the same port, so there are effectively only two ports per tile – one vertical (I chose the left edge) and one horizontal (I chose the bottom edge).</p>
<p><img class="figure" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/truchet_tiles.png" width="269" height="149" style="border:none;"></p>
<p class="figcaption">The two possible orientations of truchet tiles, with all ports and some example colors.</p>
<p>Initially, the colors are filled with random values. However, there are three different kinds of mutation taking place over time. First, the color of each port is pulled towards the color of each of its connected neighbor ports every 1/8 second (a »tick«). This makes colorful patterns »average out« over time.<br>
Second, at random intervals and random locations, »seeds« appear and dissapear: These are ports that are re-initialized to a fixed color every tick. Since that color is then distributed to the neighbor ports by the first mutation rule, the seed color seems to spill out of the seed location along the Truchet path.</p>
<p>In the final scene, these two effects are almost unnoticeable, but I didn’t remove them. What can clearly be seen, though, is the third form of color alteration: the »worms«. The worms are the white glowing things that meander through the tiling. Their positions are represented internally by the ports they occupy. Each tick, the locations of the ports are updated with the next port in the direction of the movement. By careful selection of the colors of the tiles a worm occupies, a smooth animation is realized between the ticks. At a certain position inside the glowing white part of a worm, the color of the underlying port is also changed so it seems that the worm is changing the color pattern as it wanders around.</p>
<p>Apart from the glow, the whole tunnel is drawn in only one pass using only one texture. However, that texture is carefully constructed and very specific to the Truchet tiles used and has not much to do with the color that is eventually composed by the pixel shader.</p>
<p><img class="figure" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/truchet_texture.png" width="128" height="128"></p>
<p class="figcaption">The truchet texture. The red and green channels encode the intensity of the two quarter circles, the blue channel encodes a gradient along the circumference of the circles.</p>
<p>Since the scene looked a little bit empty, I added the small floating cubes in the second part of the scene. These are simply phong-shaded chamfered cubes.</p>
<h3 style="clear:both;">Effect #5: Spiked triangle ball</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_spikeball.jpg">This is a scene I always wanted to do, but as it turned out, it doesn’t look all that great. The basis for the spike ball is another subdivided icosahedron, but with much less detail than the one used in the other spikeball scene. There are also many additional vertices added after the subdivision so that there are surfaces for the »bottom« of the ball, the main surface and the vertical edges of the spikes.</p>
<p>The final mesh generated by the CPU is static – all the shrinking and growing effects of the spikes are done in the vertex shader. In addition, a simple depth-of-field blur is used. The background is mostly gray with three (barely visible) layers of fractal clouds added to it in a pixel shader.</p>
<h3 style="clear:both;">Effect #6: Cylinder of plates</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_plates.jpg">This is perhaps the most famous scene in the intro, even though I never understood why everybody loves it so much. What we have here is just a shaft made of ~500 small cylindrical plates with a wide (additionally blended) beam of light in it. The plates are phong-shaded and a texture with random RGB values is used to add some distortion to the per-pixel normal vectors, making the surface appear rough. The background of the scene is generated by the same random geometry generation algorithm as in the first spikeball scene, but with other parameters (making a cigar-shaped room instead of a sphere-shaped one). In the second part of the scene, when the viewer is outside the shaft and looks at the greetings, the central beam is made much, much stronger and a glow effect is applied to the holes inside the plate pattern.</p>
<p>The main effect in this scene is really the movement of the plates. This is computed completely at runtime, based on a few small bitmaps describing how the greetings shall look like. The plates are considered to be arranged on an array of 48×32 fields, whereby the X direction maps to the length axis of the cylinder and the Y axis represents the 32 possible rotations around the length axis. The array wraps around the Y/rotation axis, i.e. the field above (x, 0) is (x, 31). Each plate is an object with a size of 1×1 to 1×8 fields in this array, corresponding to the different plate sizes.</p>
<p>Initially, the 500 plates are distributed randomly in the bitmap and are allowed to overlap arbitrarily. In the first few animation steps, roughly half of the plates are moved to new locations close to the old position. It’s not until a second before the viewer leaves the cylindrical shaft that the real magic begins and the plate positions are controlled by bitmaps.</p>
<p>The control bitmaps only have a three-»color« palette: plate (»I want at least one plate here«), hole (»there must not be a plate here«) and undefined (»I don’t care whether or not there is a plate here«). The first bitmap is almost completely undefined, except of a few fields that are marked as holes – this is the area where the viewer flies through the cylinder wall, and since we don’t want to collide with a plate, we need to move all plates away from there.<br>
In this first step, the algorithm for the plates is relatively easy: All plates that cover at least one field marked as »hole« are moved away so they don’t cover a hole any longer. In addition to that, a few random movements are also performed on the other plates (so that again roughtly half of the plates has been moved), but this time, care is taken that no randomly moved plate covers a hole either.</p>
<p>The animation phases that display the actual greetings text contain bitmaps where one half is undefined (this is the half on the far side of the shaft) and the other half is set to »plate« with a few holes inbetween. These holes then form the letters of the greetings.<br>
In these phases, the plate generator has some more work: It does not only need to make sure that no holes are covered, but also that every field that wants to be covered by a plate actually <b>is</b> covered. This works by searching for suitable plates in the vicinity of each uncovered position and pulling one of them there if it fits.</p>
<p>I originally planned to pre-process the plate positions in a Python script and only store the final position data in the executable, but I soon found out that the required amount of position data is too large to be stored (about 30 kb uncompressed). So I rewrote the whole plate generation in C and put it directly into the intro.</p>
<h3 style="clear:both;">Effect #7: Crystal cubes</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_crystal.jpg">This scene is my attempt at a refraction effect. Even though it looks like proper refraction, it actually isn’t – it’s just an approximation that is barely good enough.</p>
<p>Unlike most other refraction implementations I found on the internet, I wanted to take the actual depth of the refracting object into account. So I use a two-pass method: First, the back faces of the refracting cubes are drawn into a secondary buffer. In this pass, the normals at each point are encoded into color values and the depth is encoded as the alpha value; actual lighting computation don’t take place yet. In the second pass, which draws the front faces of the crystal cubes, the pixel shader has a lot more work to do. First, it uses the normal vector at each pixel to <span style="text-decoration:line-through;">compute</span>approximate the direction of the refracted ray. Based on the difference of the depth at the current pixel (which is the depth at the point where the light ray enters the crystal cube) and the alpha value the current pixel in the secondary buffer (which is the depth at the back side of the cube), the vector is scaled so that it contains the approximate screen-space x/y position of the point where the ray leaves the crystal cube. The secondary buffer is read again to extract the normal vector and refract the ray again. The final ray’s direction vector is then used to fetch a pixel from the background buffer. Specular lighting is added to that value before it’s written into the color buffer.</p>
<h3 style="clear:both;">Effect #8: Heightfield »Game of Life«</h3>
<p><img class="scene" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/scene_conway.jpg">The idea to map <a href="http://en.wikipedia.org/wiki/Game_of_life">Conway’s Game of Life</a> on an animated heightfield is based on inspiration from a friend. I think I don’t need to say much about the Game of Life aspects of the scene, because everybody should know that cellular automaton. The animations and the heightfield are the interesting aspects here.</p>
<p>The animations are done by trying to find a matched pair of neighboring born and dying cells after each generation of the game. If no such pair can be found, the cell gets born or dies by simply changing the height of the associated spot.</p>
<p>Rendering is done in two steps: Dead cells without living neighbors are drawn using a single quad. The rough structure of the ground is generated in a pixel shader. Cells that are alive or have at least one living neighbor are drawn from a static moderately-tesselated flat square mesh (289 vertices). The actual heightmap is applied in the vertex shader. Initially, I planned to use Vertex Texture Fetch for this, but in the end, I came up with a better solution: Since the shape of the hills is just a polynomial, I can of course compute it right in the vertex shader. For this reason, the shader receives only a list of the position and height of all hills in the 9 surrounding cells. The effective height of each vertex is the sum of the height functions for all 9 hills. If there are less then 9 surrounding hills for a cell, they are simply set to zero height. The normal vector is computed by taking 4 additional samples and calculating the cross product, just like in the first spikeball scene.</p>
<h3>That’s it!</h3>
<p>That’s it – now you know the basic principles how the effects in the intro are implemented. If you have any further questions, don’t hesitate to ask.</p>
				</div>
		
				<p class="postmetadata">Posted in <a href="https://keyj.emphy.de/category/computer-fun/" rel="category tag">Computer Fun</a>, <a href="https://keyj.emphy.de/category/computer-fun/demoscene/" rel="category tag">Demoscene</a> |   <a href="https://keyj.emphy.de/applied-mediocrity/#comments">8 Comments ...</a></p>
			</div>
	
		
		<div class="navigation">
			<div></div>
			<div></div>
		</div>
		
	

<!-- You can start editing here. -->

	<h1 id="comments">8 Responses to »Technical details about »Applied Mediocrity««</h1>

	<ul class="commentlist">

	
		<li class="alt" id="comment-3565">
			<div class="cmthead">
				<span class="author"><a href="http://rene-schulte.info/" rel="external nofollow" class="url">Rene Schulte</a></span>
				<span class="date">(2009-09-14 20:05)</span>
											</div>

			<div class="cmtbody">
				<p>I love the Intro and your explanationts are really good. Thanks! Keep up the awesome work!</p>
			</div>

		</li>

	
	
		<li class="" id="comment-3568">
			<div class="cmthead">
				<span class="author"><a href="http://ese/" rel="external nofollow" class="url">Schultz</a></span>
				<span class="date">(2009-09-16 12:19)</span>
											</div>

			<div class="cmtbody">
				<p>great guide.</p>
			</div>

		</li>

	
	
		<li class="alt" id="comment-3572">
			<div class="cmthead">
				<span class="author"><a href="http://adinpsz.org/" rel="external nofollow" class="url">ponce</a></span>
				<span class="date">(2009-09-19 11:41)</span>
											</div>

			<div class="cmtbody">
				<p>Awesome article, KeyJ. Thanks.</p>
			</div>

		</li>

	
	
		<li class="" id="comment-3584">
			<div class="cmthead">
				<span class="author">Dario Phong</span>
				<span class="date">(2009-11-01 22:09)</span>
											</div>

			<div class="cmtbody">
				<p>Cool explanation man. Sincere, direct and leaving no doubts. Long life to 4k coding! :)</p>
			</div>

		</li>

	
	
		<li class="alt" id="comment-3593">
			<div class="cmthead">
				<span class="author"><a href="http://code4k.blogspot.com/" rel="external nofollow" class="url">@lx</a></span>
				<span class="date">(2010-01-08 12:17)</span>
											</div>

			<div class="cmtbody">
				<p>I really appreciate the fresh feeling of this intro, with a true demo spirit… and this is a really nice article too! Effects are explained quite simply, leaving details to our imagination, which is a good way to favor new experimentation…<br>
Thanks!</p>
			</div>

		</li>

	
	
		<li class="" id="comment-3646">
			<div class="cmthead">
				<span class="author">floste</span>
				<span class="date">(2010-03-29 12:34)</span>
											</div>

			<div class="cmtbody">
				<p>Why do i get a trojan warning, when i start downloading this demo?<br>
(i actually wanted to run it on my virtual mashine anyway)</p>
			</div>

		</li>

	
	
		<li class="alt" id="comment-3647">
			<div class="cmthead">
				<span class="author"><a href="http://keyj.emphy.de/" rel="external nofollow" class="url">KeyJ</a></span>
				<span class="date">(2010-03-29 13:02)</span>
											</div>

			<div class="cmtbody">
				<p>floste: Because your virus scanner is broken. Some paranoid virus scanners complain about almost all demoscene 4k and 64k intros, and yours seems to belong into this category. Besides, it’s possible that it won’t run in a virtual machine anyway, unless you have OpenGL acceleration in your VM. If you’re on Linux or *BSD, you should rather try WINE.</p>
			</div>

		</li>

	
	
		<li class="" id="comment-3657">
			<div class="cmthead">
				<span class="author">Touraj</span>
				<span class="date">(2010-04-15 12:32)</span>
											</div>

			<div class="cmtbody">
				<p>Great work and nice site you have here. I love the crystal cubes and effect. Greetz</p>
			</div>

		</li>

	
	
	</ul>

 


<h1 id="respond">Post a Reply</h1>


<form action="https://keyj.emphy.de/wp-comments-post.php" method="post" id="commentform">


<p class="field"><input type="text" name="author" id="author" value="" size="22" tabindex="1">
<label for="author">Name <em>(required)</em></label></p>

<p class="field"><input type="text" name="email" id="email" value="" size="22" tabindex="2">
<label for="email">Mail (will not be published) <em>(required)</em></label></p>

<p class="field"><input type="text" name="url" id="url" value="" size="22" tabindex="3">
<label for="url">Website</label></p>


<p class="l"><small><strong>XHTML:</strong> You can use these tags: &lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; </small></p>

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4" wrap="virtual"></textarea></p>

<p class="field" id="captcha"><strong>Captcha:</strong><br>
<label for="answer">What is <span>brighter</span>: the <span>sun</span> or a light <span>bulb</span>?<input type="hidden" name="seed" value="1527470084"><input type="hidden" name="captcha" value=""></label> &nbsp;
<input type="text" name="answer" id="answer" value="" size="10" tabindex="5"></p>

<p class="gdprnote">By submitting the comment, you agree to the terms of the <a href="http://keyj.emphy.de/gdpr" target="_blank">Privacy Policy</a>.</p>

<p><input name="submit" type="submit" id="submit" tabindex="6" value="Submit Comment">
<input type="hidden" name="comment_post_ID" value="285">
</p>

</form>



</div>

</div>
<script type="text/javascript" src="./KeyJ&#39;s Blog _ Blog Archive » Technical details about »Applied Mediocrity«_files/wp-embed.min.js.download"></script>

<!-- 20 queries. 0.110 seconds. -->

</body></html>